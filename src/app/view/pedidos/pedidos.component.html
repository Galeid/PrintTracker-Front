<button (click)="router.navigate(['/dashboard'])">Regresar</button>
<button (click)="showDialog()">Crear</button>
<p-dialog header="Crear Pedido" [(visible)]="displayDialog" [modal]="true" [style]="{ width: '50rem', height: '100%' }">
  <div class="flex flex-column gap-2 mt-2 justify-between">
    <label>Cliente*</label>

        <p-autoComplete inputStyleClass="bg-slate-200"
        [(ngModel)]="clienteSelected"
        [suggestions]="filteredClientes"
        (completeMethod)="filterCliente($event)"
        field="nombre" />
  </div>
  <div class="flex flex-column gap-2 mt-2 justify-between">
    <label>Descripcion*</label>
    <input
      class="bg-slate-200"
        pInputText
        name="descripcion"
        [(ngModel)]="pedido.descripcion" />
  </div>
  <div class="flex flex-column gap-2 mt-2 justify-between">
    <label>Monto*</label>
    <p-inputNumber inputStyleClass="bg-slate-200"
    inputId="monto" [useGrouping]="false" mode="decimal" [maxFractionDigits]="2" locale="en-US"
    [(ngModel)]="pedido.monto" />
  </div>
  <div class="flex flex-column gap-2 mt-2 justify-between">
    <label>Servicio*</label>
      <p-dropdown
        [options]="tipoServicio"
        [(ngModel)]="pedido.tipo"
        optionLabel="label" optionValue="value" />
  </div>
  <div class="flex flex-column gap-2 mt-2 justify-between">
    <label>Tipo de Pago*</label>
    <p-dropdown
        [options]="tipoPago"
        [(ngModel)]="pedido.tipoPago"
        optionLabel="label" optionValue="value" />
  </div>
  <div class="flex flex-column gap-2 mt-2">
    <label>Fecha*</label>
    <p-calendar
      [(ngModel)]="pedido.fecha"
      dateFormat="dd/mm/yy"
      [showButtonBar]="true"/>
  </div>
  <div class="flex justify-content-end gap-2">
    <p-button label="Cancel" severity="secondary" (onClick)="displayDialog = false" />
    <p-button label="Save" (onClick)="addPedido()" />
</div>
</p-dialog>

<p-table [value]="pedidos" [tableStyle]="{ 'min-width': '50rem' }">
  <ng-template pTemplate="header">
      <tr>
          <th>NroPedido</th>
          <th>Cliente</th>
          <th>Descripcion</th>
          <th>Tipo</th>
          <th>Monto</th>
          <th>FechaCreacion</th>
          <th>FechaPago</th>
          <th>PagoEn</th>
          <th>Estado</th>
          <th>EstadoPago</th>
          <th>Accion</th>
      </tr>
  </ng-template>
  <ng-template pTemplate="body" let-pedido>
      <tr>
          <td>{{ pedido.nroPedido }}</td>
          <td>{{ pedido.cliente.nombre }}</td>
          <td>{{ pedido.descripcion }}</td>
          <td>{{ pedido.tipo }}</td>
          <td>{{ pedido.monto }}</td>
          <td>{{ pedido.fecha }}</td>
          <td>{{ pedido.fechaPago }}</td>
          <td>{{ pedido.tipoPago }}</td>
          <td>{{ pedido.estado }}</td>
          <td>{{ pedido.estadoPago }}</td>
          <td>
            @if (pedido.estadoPago != "pagado") {
              <p-button icon="pi pi-check" label="Pagar" (click)="pagarPedido(pedido)"/>
            }
            @if (isToday(pedido.fecha)) {
              <p-button icon="pi pi-times" label="Anular" (click)="anularPedido(pedido)"/>
            }
          </td>
      </tr>
  </ng-template>
</p-table>
